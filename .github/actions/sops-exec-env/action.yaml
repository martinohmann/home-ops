# yaml-language-server: $schema=https://www.schemastore.org/github-action.json
---
name: sops-exec-env
description: Securely execute commands with encrypted secrets in GitHub Actions.
author: martinohmann
inputs:
  env_file:
    description: 'The environment file to decrypt and pass to the command'
    required: true
  run:
    description: 'The command to run'
    required: true
runs:
  using: composite
  steps:
    - name: Setup sops
      uses: nhedger/setup-sops@d2319c095d20965a22c10ffe3bf0c2e969baaa2c # v2.1.1

    - name: Run sops exec-env
      shell: bash
      run: |
        sops exec-env '${{ inputs.env_file }}' '${{ inputs.run }}'
